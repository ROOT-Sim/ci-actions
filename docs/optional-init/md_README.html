<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ci-actions-test: ROOT-Sim Actions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ci-actions-test
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ROOT-Sim Actions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://github.com/ROOT-Sim/ci-actions/actions/workflows/ci.yml"><img src="https://github.com/ROOT-Sim/ci-actions/actions/workflows/ci.yml/badge.svg?branch=master" alt="ci" style="pointer-events: none;" class="inline"/></a></p>
<p>This is the set of actions that are used across the different ROOT-Sim repositories to support CI/CD of the components of the project.</p>
<p>Currently, the actions supported are:</p><ul>
<li>Ensure that proper compilers are available (clang, gcc) on the three major platforms (Ubuntu, macOS, Windows)</li>
<li>Install MPI (openmp on Ubuntu, mpich on macOS, Microsoft MPI on Windows)</li>
<li>Compile and test a CMake project</li>
<li>Generate the documentation of the project</li>
<li>Compute the documentation coverage</li>
</ul>
<h1><a class="anchor" id="autotoc_md1"></a>
License</h1>
<p>This project is released under the <a href="LICENSES/GPL-3.0-only.txt">GPLv3</a>.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Usage</h1>
<p>This is a short walk-through, used mostly for internal reference.</p>
<p>To run CI of C/C++ projects, testing on all operating systems with a combination of the compilers and libraries considered for the project, do the following:</p>
<div class="fragment"><div class="line">on:</div>
<div class="line">  push:</div>
<div class="line">  pull_request:</div>
<div class="line">  schedule:</div>
<div class="line">    - cron: &quot;0 2 * * 1&quot;</div>
<div class="line"> </div>
<div class="line">build_and_test:</div>
<div class="line">    runs-on: ${{ matrix.os }}</div>
<div class="line">    strategy:</div>
<div class="line">      fail-fast: false</div>
<div class="line">      matrix:</div>
<div class="line">        os: [ ubuntu-latest, windows-latest, macos-latest ]</div>
<div class="line">        compiler: [ clang, gcc ]</div>
<div class="line">        type: [ Debug, Release ]</div>
<div class="line">    steps:</div>
<div class="line">      - name: Checkpout repository</div>
<div class="line">        uses: actions/checkout@v3</div>
<div class="line">      - name: Initialize Environment</div>
<div class="line">        uses: ROOT-Sim/ci-actions/init@v1.4</div>
<div class="line">      - name: Build &amp; Test</div>
<div class="line">        uses: ROOT-Sim/ci-actions/cmake@v1.4</div>
<div class="line">        with:</div>
<div class="line">          build-dir: ${{ runner.workspace }}/build</div>
<div class="line">          cc: ${{ matrix.compiler }}</div>
<div class="line">          build-type: ${{ matrix.type }}</div>
<div class="line">          run-test: true</div>
</div><!-- fragment --><p>Note that the <code>init</code> action, by default, installs all the dependencies that are used by the ROOT-Sim core project, both for building and for documentation purposes. Among them, there are the MPI library and Doxygen. These dependencies take time to be configured, especially on Windows and Linux. If some project does not need them, they can be phased out from the initialization. This can be done as follows:</p>
<div class="fragment"><div class="line">- name: Initialize Environment</div>
<div class="line">  uses: ROOT-Sim/ci-actions/init@v1.4</div>
<div class="line">  with:</div>
<div class="line">    with-mpi: no</div>
<div class="line">    with-doxygen: no</div>
</div><!-- fragment --><p>In order to generate the documentation of the project, the following step can be included to generate the Doxygen documentation:</p>
<div class="fragment"><div class="line">- name: Generate Documentation</div>
<div class="line">  uses: ROOT-Sim/ci-actions/docs@v1.4</div>
</div><!-- fragment --><p>Note that in the above case, it is automatically triggering the build of a <code>doc</code> target from <code>CMakeLists.txt</code>. If the target to generate Doxygen documentation is different, it can be specified with the <code>docs-target</code> parameter:</p>
<div class="fragment"><div class="line">- name: Generate Documentation</div>
<div class="line">  uses: ROOT-Sim/ci-actions/docs@v1.4</div>
<div class="line">  with:</div>
<div class="line">    docs-target: generate-documentation</div>
</div><!-- fragment --><p>If you want to perform a documentation coverage, the following step can be included. It <em>must</em> come after the <code>docs</code> action. If running in a pull request, it will comment the pull request with information on the coverage.</p>
<div class="fragment"><div class="line">- name: Documentation Coverage</div>
<div class="line">  uses: ROOT-Sim/ci-actions/docs-coverage@v1.4</div>
<div class="line">  with:</div>
<div class="line">    accept-threshold: &quot;60.0&quot;</div>
<div class="line">    build-path: build/docs</div>
</div><!-- fragment --><p>The previous action creates and environment message in the variable <code>COMMENT</code>. You can make an automatic comment in a pull request using the following step, after its execution:</p>
<div class="fragment"><div class="line">- name: Comment PR</div>
<div class="line">  uses: actions/github-script@v3</div>
<div class="line">  with:</div>
<div class="line">    github-token: ${{secrets.GITHUB_TOKEN}}</div>
<div class="line">    script: |</div>
<div class="line">      github.issues.createComment({</div>
<div class="line">        issue_number: context.issue.number,</div>
<div class="line">        owner: context.repo.owner,</div>
<div class="line">        repo: context.repo.repo,</div>
<div class="line">        body: ${{env.COMMENT}}</div>
<div class="line">      })</div>
</div><!-- fragment --><p>Also, an env <code>acceptable</code> variable with the value 0 or 1 is set, to determine whether the test has passed or not.</p>
<p>If you want to perform a REUSE check (which fails the CI if the check does not pass), you can use the following:</p>
<div class="fragment"><div class="line">- name: REUSE check</div>
<div class="line">  uses: ROOT-Sim/ci-actions/reuse-check@v1.4</div>
</div><!-- fragment --><p>Another available action allows to deploy the documentation into a GitHub Pages website in the current repository. This action can be used as such:</p>
<div class="fragment"><div class="line">- name: Website Deployment</div>
<div class="line">  uses: ROOT-Sim/ci-actions/website-deploy@v1.4</div>
</div><!-- fragment --><p>The documentation will be deployed in the <code>/docs/[branchname]/</code> path, where <code>[branchname]</code> is either <code>master</code> or <code>develop</code>. The documentation is not actually deployed for any other branch. Additionally, it will copy the <code>README.md</code> file in the root directory of the website: if it is used in the site, the content of the page will therefore be automatically updated. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
